---
title: arp子网查询&跨子网查询
toc: true
date: 2019-11-13 21:28:59
tags: [go,protocol,arp]
---
```
当前网段为：192.168.1.0/24
当前网络ip：192.168.1.1
源mac地址 ：aa:00:01:01:01:01
广播地址  ：ff:ff:ff:ff:ff:ff
```
## @子网查询
### 1.广播
下面为一个查询`192.168.1.2` mac地址的arp请求
6字节 |  6字节|2字节|2字节|2字节|1字节|1字节|2字节|6字节|4字节|6字节|4字节
---|---       |---- |---|---|---|---|---|---|---|---|--|---|----|
源Mac地址 | 目的Mac地址|以太网帧类型|硬件类型|协议类型|地址长度|协议地址长度|操作码|源mac地址|源ip地址|目的mac地址|目的ip地址
aa:00:01:01:01:01|ff:ff:ff:ff:ff:ff|0x806|1|0x800|6|4|1|aa:00:01:01:01:01|192.168.1.1|?|192.168.1.2

可以看到在arp报文中，目的mac地址留空，期待arp回复的时候填满，这样就拿到了mac地址

## @跨子网查询
### 1.广播
下面为一个查询`115.159.254.64` mac地址的arp请求,跨子网通信区别在于目的mac地址为`网关mac地址`
6字节 |  6字节|2字节|2字节|2字节|1字节|1字节|2字节|6字节|4字节|6字节|4字节
---|---       |---- |---|---|---|---|---|---|---|---|--|---|----|
源Mac地址 | 网关mac地址|以太网帧类型|硬件类型|协议类型|地址长度|协议地址长度|操作码|源mac地址|源ip地址|目的mac地址|目的ip地址
aa:00:01:01:01:01|*****************|0x806|1|0x800|6|4|1|aa:00:01:01:01:01|192.168.1.1|?|192.168.1.2

直接将数据发往网关，网关在根据一下跳地址继续发往目的地

